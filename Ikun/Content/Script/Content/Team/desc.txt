越是分化严重, 越是需要阵型
后排的意义在于能集火同一个单位

2025/5/6:
    预期表现:
        1.当有较多后排时, 前排用来保护后排; 当自己的后排较少时, 前排行为则是直冲对面后排
        2.作为一个前排, 血量较少时往后拉, 若有牧师单位则治疗结束后回到前排(考虑直接标记失去战斗能力)
        3.对面人数越少则后排扇形阵型角度越大
        4.对于非指向性技能的后排要考虑前排技能轨迹遮挡
        5.包抄侧翼的作用: 1.限制对方残血单位逃跑 2.威胁对方后排
        6.对方大规模冲锋时, 如阻挡失败则群体向后拉
        * 其实团体性体现在多个单位对于对面的某些威胁行为具有同时反应的表现
          就比如对面冲锋时后排单位同时往后拉, 体现在"同时"
    Team模块需要:
        给战斗单位留置大致阵型站位
        根据己方后排数量决定前排对线单位
        根据对方单位数量决定后排阵型的扇形角度
        检测对方前排大致位置, 过近则向后拉; 其实就是对面前排冲过来就需要集体向后拉维持保护后排的阵型
    单位行为树:
        Selector
            Decorator没有紧急移动坐标
                如有则移动
            Sequence周期性自主战斗行为
                Decorator有战术位置且距离战术位置太远
                    移动
                检测或获取当前目标
                SelectAbility
                寻找好的施法位置
                转身
                移动
                Aim
                ActiveAbility
                是否需要切树

我感觉这个东西越写越多了，你能给我提一个需求吗？就是Team的，或者你直接给我一个文章，说做到这样就行，我现在一直想着参考魔兽争霸的80人口团战来写的我的团队指挥，结果越想越复杂
ChatGPT：
    你确实走得很深了，现在已经到了“如何在微观层面最优化控制每个单位”的地步，这是一个典型的系统膨胀信号。我来给你一个清晰的Team AI 战斗调度系统的完成线——你把它当成第一个「Done」标准。
✅ 标准需求：中等复杂度 RTS 团队AI系统（推荐完成线）
🎯 目标
    实现一个支持 20–80 单位团战的团队 AI 框架，能够合理调度单位至指定位置、维持战斗队形，并根据战斗阶段动态调整策略。
🔹 一、单位配置基础
    每个单位具备：
        可承担的战场位置（前排/后排/侧翼/高地等）
        战斗能力元标签（如远程/近战/治疗/输出/控制等，策划配置即可）
        当前血量/资源作为调度参考指标
🔹 二、团队配置与偏好
    团队AI具备：
        战场位置配给率（如前3 后5 侧2）
        最小/最大战力阈值（过少自动撤退或合流）
        当前战术状态：集结、搜索、接敌、战斗、脱战
🔹 三、指令系统（Team -> Role）
    团队AI控制以下内容：
        阶段	        行为
        战前	        分配职业 → 分配位置
        初始接敌	    所有人调整站位，进入战斗状态
        战斗中	        持续根据血量、距离重调站位
        被压制/胜利	    发起撤退或合流
🔹 四、技能与遮挡控制
    投射类单位（如弓箭/法术）：
        战斗中每隔 X 秒尝试重新寻找无遮挡位置
        若遮挡过高，尝试侧翼或高地站位
    近战单位：
        跑到离敌最近的“最近未被己方遮挡”的位置
        或者锁定目标后考虑最近可攻击位置
🔹 五、行为树集成点
    切树时机统一由 Team 控制：
    每个角色行为树支持“等待切树”
    Team统一下达“切入战斗树”/“脱离战斗树”等指令
✳️ 总结：完成线判断标准
    你的Team系统可在AI单位数到达40时，仍能在游戏中稳定、自然地调度战斗站位，并合理切换行为树（比如从巡逻切战斗，再切回）。
        单位行为看起来不愚蠢，整体布局有战术感，即为合格。
🛑 不推荐此时加入的功能（会膨胀）：
    精细遮挡图（耗性能）
    完整遮挡角度多点分析（对单单位不值）
    单位协同火力预测/包围夹击
    决策ML或分布式策略树
你现在做到的位置，已经接近“目标线”，再写多就是“模拟人脑指挥”那一档了。建议就此打住，先封装这个阶段的逻辑。

开发Step:
    入战时
        绘制战区影响力图
            影响力图要素: 我方单位人数
        初始角色赋予
    战斗中
        动态角色变化
            

战场角色BattleRole
    近战输出MeleeDPS
    远程输出RangedDPS
    坦克Tank
    控场CrowdControl
    治疗Healer
    辅助Support
    游走Ganker
    召唤师Summoner

战场位置BattlePosition
    前排Frontline
    中排Midline
    后排Backline
    侧翼Flank
    后方Rear
    支援Support
    指挥中心CmdPost
    伏击点Ambush
    狙击点SniperNest
    侦查位ScoutPos
    预备队Reserve
    高地ElevatedPos
    阻塞点Chokepoint
    据点Strongpoint
    空中支援AirSupport

ChatGPT:
看完你现有的团队 AI 和影响力图（InfluenceMap）代码后，我觉得可以在以下几个方面进一步扩展和完善，让你的团队战斗更加智能化、丰富和可配置：
1. 动态角色分工（Role Assignment）
职责标签
给每个角色加上“职责”属性（坦克、输出、治疗、控制等），然后根据战场态势动态调整各自职责的优先级和位置分配。
自动补位
当某个职责的成员死亡或脱离战斗时，自动从后排或支援角色中选出最合适的替补。
2. 威胁评估与目标选择（Threat & Targeting）
仇恨值系统
基于对手的攻击频率、所受伤害、治疗量等因素，给每个敌人分配一个“威胁值”，让角色优先攻击高威胁目标。
集中火力（Focus Fire）
队长或某个 AI 节点下达“集火”指令，临时给某个高威胁或高价值目标施加额外伤害加成。
3. 阵型与战术切换（Formations & Tactics）
预设阵型
支持多种阵型（楔形、环形、散开、护盾阵等），并在不同场景（追击、包围、撤退）之间动态切换。
基于影响力图的阵型调整
利用 InfluenceMap 中的热力分布，自动判断哪里敌人密集、哪里己方薄弱，然后调整阵型密度。
4. 路径规划与躲避（Pathfinding & Evasion）
A* 或导航网格（NavMesh）
让角色能够绕开障碍物，寻找最佳路径接近或脱离战斗。
避弹与闪避
当检测到敌方大范围技能即将落地，自动判断安全区域并躲避。
5. 支援与协同（Support & Coordination）
治疗优先级
根据队友的生命值百分比、所受伤害速率，智能选择治疗或增益目标。
增益/减益技能联动
例如先给敌人施加减速或破甲状态，再集中火力；或先给己方施加增益，再推进。
6. 资源管理（Cooldown & Mana）
技能冷却与能量管理
让 AI 学会在关键时刻保留大招，或在资源充足时快速爆发。
道具使用
如自动吃药、投掷炸弹、放置陷阱等。
7. 侦察与视野控制（Scouting & Vision）
前哨兵
指派一个或多个成员做侦察，探测隐藏或远处敌人，然后更新 InfluenceMap 信息。
动态视野图
扩展 InfluenceMap，让它不仅记录己敌双方位置，还能记录“可见度”权重。
8. 撤退与重组（Retreat & Regroup）
安全阈值
当全队血量或人数低于一定比例时，触发“撤退”状态：全队往安全点移动，等待回复或援军。
分散与集合
当敌方大范围技能过来时，自动分散；技能结束后，再集合到 Leader 周围重组阵型。
9. 学习与适应（Learning & Adaptation）
简单记忆系统
记录上一次战斗中最危险的区域、最致命的敌人，下一次遇到相似情况时优先回避或集火。
行为权重调整
根据战斗结果（胜/负），动态调整各类行为（进攻、撤退、支援）的触发概率。
10. 可视化与调试工具
实时热力图
在游戏编辑器中可视化 InfluenceMap 的热度分布，帮助调试参数。
决策日志
输出 AI 在每次决策时的关键数据（威胁值、阵型选择、目标列表），方便分析和优化。